"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function svgInit(){var t=graph.svg.parentNode.getBoundingClientRect();graph.svg.setAttribute("viewBox","0 0 "+t.width+" "+t.height),graph.svg.setAttribute("width",t.width),graph.svg.setAttribute("height",t.height),graph.width=graph.svg.getBoundingClientRect().width,graph.height=graph.svg.getBoundingClientRect().height,graph.multi=graph.width/8.5}function framework(){graph.g_line=document.createElementNS("http://www.w3.org/2000/svg","g"),graph.g_line.classList.add("framework-line");for(var t="M"+(graph.width/2+graph.width/2.5*Math.cos(0))+" "+(graph.height/2+graph.width/2.5*Math.sin(0)),e=0;e<12;e++){t+=" L"+(graph.width/2+graph.width/2.5*Math.cos(2*e*Math.PI/12))+" "+(graph.height/2+graph.width/2.5*Math.sin(2*e*Math.PI/12));var a=document.createElementNS("http://www.w3.org/2000/svg","path"),i="M"+graph.width/2+" "+graph.height/2;i+=" L"+(graph.width/2+graph.width/2.5*Math.cos(2*e*Math.PI/12))+" "+(graph.height/2+graph.width/2.5*Math.sin(2*e*Math.PI/12)),a.setAttributeNS(null,"d",i),graph.g_line.appendChild(a)}graph.svg.appendChild(graph.g_line),t+=" Z";var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.classList.add("framework"),r.setAttributeNS(null,"d",t),graph.svg.appendChild(r)}function frameworkText(){graph.g_text=document.createElementNS("http://www.w3.org/2000/svg","g"),graph.g_text.classList.add("framework-text"),graph.svg.appendChild(graph.g_text);for(var t=0;t<12;t++){var e=document.createElementNS("http://www.w3.org/2000/svg","text");0==t&&(e.textContent="jan"),1==t&&(e.textContent="feb"),2==t&&(e.textContent="mar"),3==t&&(e.textContent="apr"),4==t&&(e.textContent="may"),5==t&&(e.textContent="jun"),6==t&&(e.textContent="jul"),7==t&&(e.textContent="aug"),8==t&&(e.textContent="sep"),9==t&&(e.textContent="oct"),10==t&&(e.textContent="nov"),11==t&&(e.textContent="dec"),e.setAttributeNS(null,"x",graph.width/2+graph.width/2.45*Math.cos(2*t*Math.PI/12)),e.setAttributeNS(null,"y",graph.width/2+graph.width/2.45*Math.sin(2*t*Math.PI/12)),e.setAttributeNS(null,"transform","rotate("+(90+30*t)+","+(graph.width/2+graph.width/2.45*Math.cos(2*t*Math.PI/12))+","+(graph.width/2+graph.width/2.45*Math.sin(2*t*Math.PI/12))+")"),graph.g_text.appendChild(e)}}function frameworkPreventLine(t){for(var e,a,i="M",r=0;r<12;r++)0==r?(e=t*graph.multi*-1*.75,a=t*graph.multi*0):1==r?(e=t*graph.multi*-1*.63,a=t*graph.multi*-1*.37,i+=" L"):2==r?(e=t*graph.multi*-1*.37,a=t*graph.multi*-1*.63,i+=" L"):3==r?(e=t*graph.multi*0,a=t*graph.multi*-1*.75,i+=" L"):4==r?(e=t*graph.multi*.37,a=t*graph.multi*-1*.63,i+=" L"):5==r?(e=t*graph.multi*.63,a=t*graph.multi*-1*.37,i+=" L"):6==r?(e=t*graph.multi*.75,a=t*graph.multi*0,i+=" L"):7==r?(e=t*graph.multi*.63,a=t*graph.multi*.37,i+=" L"):8==r?(e=t*graph.multi*.37,a=t*graph.multi*.63,i+=" L"):9==r?(e=t*graph.multi*0,a=t*graph.multi*.75,i+=" L"):10==r?(e=t*graph.multi*-1*.37,a=t*graph.multi*.63,i+=" L"):11==r&&(e=t*graph.multi*-1*.63,a=t*graph.multi*.37,i+=" L"),i+=graph.width/2+graph.width/6*Math.cos(2*r*Math.PI/12)-e+" "+(graph.height/2+graph.width/6*Math.sin(2*r*Math.PI/12)-a);i+=" Z";var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.classList.add("line-prevent"),h.setAttributeNS(null,"d",i),graph.svg.appendChild(h);var n=document.createElementNS("http://www.w3.org/2000/svg","text");n.textContent="+"+t.toFixed(1)+"°C",n.setAttributeNS(null,"x",graph.width/2+graph.width/5.8*Math.cos(0)-t*graph.multi*-1*.75),n.setAttributeNS(null,"y",graph.width/2+graph.width/5.8*Math.sin(0)),n.setAttributeNS(null,"transform","rotate(90,"+(graph.width/2+graph.width/5.8*Math.cos(0)-t*graph.multi*-1*.75)+","+(graph.height/2+graph.width/5.8*Math.sin(0))+")"),n.classList.add("text-prevent"),graph.svg.appendChild(n)}function loop(t){if(t==data.length-1)return!1;graph.line[graph.line.length]=new line(t),graph.line[graph.line.length-1].drawPolygon(),graph.line[graph.line.length-1].onClick(),graph.year_display.textContent=data[t].year,setTimeout(function(){loop(t+1)},100)}function initTimeline(){var t=graph.timeline_container.offsetWidth/21;t=t>50?t:50,graph.timeline_svg.setAttribute("viewBox","0 0 "+t*(data.length-1)+" 100"),graph.timeline_svg.setAttribute("width",t*(data.length-1)),graph.timeline_svg.setAttribute("height","100");for(var e=document.createElementNS("http://www.w3.org/2000/svg","path"),a="",i=0;i<data.length-1;i++){a+=0==i?"M"+(i*t+t/2)+" "+(40-28*(data[i].sum+min)):" L"+(i*t+t/2)+" "+(40-28*(data[i].sum+min));var r=document.createElement("button");r.className="timeline-item",r.style.transform="translate("+(i*t+t/2)+"px,"+(40-28*(data[i].sum+min))+"px)";var h=document.createElement("span");h.innerHTML=data[i].year,r.appendChild(h),graph.timeline_container.appendChild(r),graph.timeline_link[graph.timeline_link.length]=r}e.setAttribute("d",a),graph.timeline_svg.appendChild(e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d","M0 40 L"+(t*data.length-1)+" 40"),n.classList.add("line-zero"),graph.timeline_svg.appendChild(n);var l=document.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",5),l.setAttribute("y",35),l.textContent="0°C",graph.timeline_svg.appendChild(l)}function svgSpecificsInit(){graph.detailed_container.offsetWidth,graph.detailed_svg.setAttribute("viewBox","0 0 "+graph.detailed_container.offsetWidth+" "+graph.detailed_container.offsetHeight),graph.detailed_svg.setAttribute("width",graph.detailed_container.offsetWidth),graph.detailed_svg.setAttribute("height",graph.detailed_container.offsetHeight);for(var t=graph.detailed_container.offsetWidth/12,e=graph.detailed_container.offsetHeight/2,a=document.createElementNS("http://www.w3.org/2000/svg","path"),i="",r=0;r<12;r++){var h=document.createElement("div");h.className="month-pin",h.style.transform="translate("+(t/2+r*t)+"px, "+e+"px)",graph.detailed_month_pins[r]=h,graph.detailed_container.appendChild(h),i+=0==r?"M"+(t/2+r*t)+" "+e:" L"+(t/2+r*t)+" "+e}a.setAttributeNS(null,"d",i),graph.detail_svg_path=a,graph.detailed_svg.appendChild(a)}function svgSpecificUpdate(t){for(var e=graph.timeline_link.indexOf(t),a=graph.detailed_container.offsetWidth/12,i=graph.detailed_container.offsetHeight/2,r="",h=0;h<12;h++){graph.detailed_month_pins[h].style.transform="translate("+(a/2+h*a)+"px, "+(i-42*data[e].values[h])+"px)",r+=0==h?"M"+(a/2+h*a)+" "+(i-42*data[e].values[h]):" L"+(a/2+h*a)+" "+(i-42*data[e].values[h]);var n=220-(parseFloat(data[e].values[h])+Math.abs(values_min))/(values_max+Math.abs(values_min))*220;graph.detailed_month_pins[h].style.backgroundColor="hsl("+n+", 100%, 30%)",graph.detailed_month_pins[h].innerHTML=data[e].values[h]>=0?"<p>+"+data[e].values[h]+"</p>":"<p>"+data[e].values[h]+"</p>"}graph.detail_svg_path.setAttributeNS(null,"d",r),graph.year_display.textContent=data[e].year}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}(),graph={};graph.svg=document.querySelector(".container-graph svg"),graph.line=[],graph.year_display=document.querySelector(".year-display"),graph.timeline_container=document.querySelector(".container-timeline .timeline"),graph.timeline_svg=document.querySelector(".container-timeline svg"),graph.timeline_link=[],graph.timeline_scrollbar=document.querySelector(".container-timeline .scroll-bar"),graph.timeline_link_last=void 0,graph.detailed_container=document.querySelector(".container-detailed-graph"),graph.detailed_svg=document.querySelector(".container-detailed-graph svg"),graph.detailed_month_pins=[],svgInit();for(var sums=[],values=[],i=0;i<data.length;i++){for(var j=data[i].values.length-1;j>=0;j--)values[values.length]=data[i].values[j];sums[sums.length]=data[i].sum}var values_min=Math.min.apply(Math,values),values_max=Math.max.apply(Math,values);console.log(values_min);var min=Math.min.apply(Math,sums),max=Math.max.apply(Math,sums)+Math.abs(min),line=function(){function t(e){_classCallCheck(this,t),this.values=data[e].values,this.node,this.year=data[e].year,this.sum=data[e].sum,this.index=e}return _createClass(t,[{key:"drawPolygon",value:function(){for(var t,e,a="M",i=0;i<12;i++)void 0!=this.values[i]&&(0==i?(t=this.values[i]*graph.multi*-1*.75,e=this.values[i]*graph.multi*0):1==i?(t=this.values[i]*graph.multi*-1*.63,e=this.values[i]*graph.multi*-1*.37,a+=" L"):2==i?(t=this.values[i]*graph.multi*-1*.37,e=this.values[i]*graph.multi*-1*.63,a+=" L"):3==i?(t=this.values[i]*graph.multi*0,e=this.values[i]*graph.multi*-1*.75,a+=" L"):4==i?(t=this.values[i]*graph.multi*.37,e=this.values[i]*graph.multi*-1*.63,a+=" L"):5==i?(t=this.values[i]*graph.multi*.63,e=this.values[i]*graph.multi*-1*.37,a+=" L"):6==i?(t=this.values[i]*graph.multi*.75,e=this.values[i]*graph.multi*0,a+=" L"):7==i?(t=this.values[i]*graph.multi*.63,e=this.values[i]*graph.multi*.37,a+=" L"):8==i?(t=this.values[i]*graph.multi*.37,e=this.values[i]*graph.multi*.63,a+=" L"):9==i?(t=this.values[i]*graph.multi*0,e=this.values[i]*graph.multi*.75,a+=" L"):10==i?(t=this.values[i]*graph.multi*-1*.37,e=this.values[i]*graph.multi*.63,a+=" L"):11==i&&(t=this.values[i]*graph.multi*-1*.63,e=this.values[i]*graph.multi*.37,a+=" L"),a+=graph.width/2+graph.width/6*Math.cos(2*i*Math.PI/12)-t+" "+(graph.height/2+graph.width/6*Math.sin(2*i*Math.PI/12)-e));this.year!=data[data.length-1].year&&(a+=" Z"),this.node=document.createElementNS("http://www.w3.org/2000/svg","path"),this.node.setAttributeNS(null,"d",a);var r=220-(this.sum+Math.abs(min))/max*220;this.node.setAttributeNS(null,"style","stroke: hsl("+r+", 100%, 30%)"),this.node.classList.add("line-year"),graph.svg.appendChild(this.node)}},{key:"onClick",value:function(){var t=this;this.node.addEventListener("click",function(){var e=graph.timeline_container.offsetWidth/21;e=e>50?e:50,graph.timeline_container.scrollLeft=t.index*e;var a=graph.timeline_container.scrollLeft/(graph.timeline_svg.getAttribute("width")-graph.timeline_container.offsetWidth);graph.timeline_scrollbar.style.transform="scaleX("+a+")",graph.timeline_link[t.index].click()})}}]),t}();framework(),frameworkText(),frameworkPreventLine(1.5),frameworkPreventLine(2),loop(0),initTimeline(),graph.timeline_container.addEventListener("wheel",function(t){graph.timeline_container.scrollLeft+=t.deltaY,graph.timeline_container.scrollLeft+=t.deltaX;var e=graph.timeline_container.scrollLeft/(graph.timeline_svg.getAttribute("width")-graph.timeline_container.offsetWidth);graph.timeline_scrollbar.style.transform="scaleX("+e+")"}),document.addEventListener("wheel",function(t){t.preventDefault()});for(var i=graph.timeline_link.length-1;i>=0;i--)graph.timeline_link[i].addEventListener("click",function(){this.classList.toggle("active"),graph.svg.parentNode.classList.add("reduce"),graph.detailed_container.classList.add("active"),void 0!=graph.timeline_link_last&&graph.timeline_link_last!=this&&graph.timeline_link_last.classList.remove("active"),graph.timeline_link_last!=this?graph.timeline_link_last=this:(graph.timeline_link_last=void 0,graph.svg.parentNode.classList.remove("reduce"),graph.detailed_container.classList.remove("active")),this.classList.contains("active")&&svgSpecificUpdate(this)});svgSpecificsInit(),setTimeout(function(){graph.timeline_container.style.transform="translateY(0px)"},100*data.length);